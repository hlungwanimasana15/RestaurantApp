var SvCtrlV2;(function(n){n.SavableEntityCN="isv";n.SavedCN="saved";n.SaveCtrlContainerCN="isvctrl";n.FlyoutErrorCN="err";n.InProgressCN="ing";n.GetErrCN="b_geterr";n.FocusCN="isvfoc";n.HoverCN="b_isvhvr";n.SaveCtrlHoveredCN="b_schvr";n.CurrentElementCN="b_isvcur";n.NarrowImageCN="b_nrrwimg";n.NarrowImageRightCN="b_nrrwimgr";n.NarrowImageBottomCN="b_nrrwimgb";n.HasFlyoutCN="b_flyt";n.FlyoutActiveCN="b_scactive";n.SublabelActiveCN="b_scslbl";n.ErrDispCN="b_scdisp";n.DeactivateCN="scdactve";n.errStateVisibleCN="errvsbl";n.errStateInvisibleCN="errinvsbl";n.RemovableCN=[n.SavedCN,n.FocusCN,n.HoverCN,n.InProgressCN,n.FlyoutErrorCN,n.SaveCtrlHoveredCN];n.CollectionAttr="collection";n.CollectionItemIdAttr=n.CollectionAttr+"ItemId";n.IsSuccessAttr="isSuccess";n.ParentElementAttr="parentElement";n.UndefinedString="undefined";n.RelatedTargetAttr="relatedTarget";n.CurrentTargetAttr="currentTarget";n.TargetAttr="target";n.PixelUnit="px";n.SavesGenericItemDataAttr="data-saves-generic-item";n.ScrollBindDataAttr="data-scrbind";n.ClassListAttr="classList";n.CollectionIdDataAttribute="data-svcid";n.KCTDataAttr="data-svkct";n.SavedDataAttr="data-svd";n.SaveErrorMapAttr="data-save-error-map";n.CollRegisterEN="onCollRegister";n.PartnerRegisterEN="onPartnerRegister";n.DeregisterPersBtnEN="onDeregisterPersBtn";n.UpdateHoverBoxEN="onUpdateHoverBox";n.scEngagementEN="onSCEngagement";n.FocusInEN=["mouseenter","focusin"];n.FocusOutEN=["mouseleave","focusout"];n.CollListExpandEN="onCollListExpand";n.VisualStateChangedEN="onVisualStateChanged";n.CollectionsGottenEN="onCollectionsGotten";n.HostSavesControlClickedEN="onHostSavesControlClicked";n.PersButtonInteractEN="onPersButtonInteract";n.SaveAddEN="onSaveAdd";n.SaveDelEN="onSaveDel";n.SaveControlErrorEN="onSaveControlError";n.ControlAppendedEN="onControlAppended";n.CurrentCollIdSetEN="onCurrentCollIdSet";n.HoverElementSetEN="onHoverElementSet";n.SaveButtonClickEN="onSaveButtonClick";n.SaveButtonFocusEN="onSaveButtonFocus";n.ChevronToggleCollListEN="onBtnToggleCollList";n.FavAddEN="onFavAdd";n.FavDeleteEN="onFavDel";n.CollBCLoadedEN="CollectionsBCLoaded";n.CurrentElementSetEN="onCurrentElementSet";n.UpdateSaveStateEN="updateSaveState";n.TypeToAttributeMap={webdoc:"url",recipe:"sid",video:"mid",image:"cid",product:"cid"};n.ScrollEvent="scroll";n.ResizeEvent="resize";n.CustomCollDummyId="CustomCollId";n.IcnsBGColorCss="--icn-bg-color";n.IcnLblTxtClrCss="--svlbl-txt-color";n.SavedIcnCss="--svicn-bg-img";n.UnsavedIcnCss="--unsvicn-bg-img";n.SavedPromIcnCss="--svicn-bg-img-prominent";n.UnsavedPromIcnCss="--unsvicn-bg-img-prominent";n.SavePromClrCss="#5087EC";n.SavePromTxtClrCss="#FFFFFF";n.FlyoutBGClrCss="--flyout-bg-clr";n.FlyoutLnkClrCss="--flyout-lnk-clr";n.FlyoutTxtClrCss="--flyout-txt-clr";n.UiErrorStates=["Ok","AddItem","RemoveItem","GetCollection","CreateCollection","Mismatch","Intermittent","BadItemData"]})(SvCtrlV2||(SvCtrlV2={})),function(n){function y(t){return t&&l(t,n.SavableEntityCN)}function p(n,t){return!n&&!t?"":n?t?"type=".concat(n,"&Comp=").concat(t):"type=".concat(n):"Comp=".concat(t)}function i(n,t){try{var i=_d.elementsFromPoint(n,t)||[];return Array.prototype.slice.call(i)}catch(r){return[]}}function r(n,t){for(var f,r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];for(f=n&&n.length||0,r=0;r<f;r++)t(n[r],u)}function w(n){try{return JSON.parse(n)}catch(t){return null}}function e(n,t){if(n)for(var i in n)t(i,n[i])}function b(n,t){var i=n;return e(t,function(n,t){i[n]=t}),i}function k(n){if(n&&n.target){var t=n.target.getBoundingClientRect(),u=t.x,f=t.right,e=t.y,o=t.bottom,s=i((u+f)/2,(e+o)/2);r(s,function(n){n.tagName==="A"&&n.hasAttribute("h")&&_w.si_T&&_w.si_T(n.getAttribute("h"))})}}function d(n,t){if(!(n&&t))return!1;try{return n.contains(t)}catch(i){return!1}}function o(n){if(!n)return null;try{return n.getBoundingClientRect()}catch(t){return null}}function g(n,t){var r;if(!(n&&t))return!1;try{if(r=o(n),!r)return;var u=r.x,f=r.y,e=i(u,f);return tt(e,t)}catch(s){return!1}}function nt(t){var i,r;if(!t||!n.localCollectionNames)return!1;i=t.toLowerCase();for(r in n.localCollectionNames)if(i==r.toLowerCase())return!0;return!1}function tt(n,t){try{return n&&n.length&&n.indexOf(t)>-1}catch(i){return!1}}function it(n,t){var i,r;return!n||!t?null:Element.prototype.closest?n.closest(t):(i=Element.prototype.matches?Element.prototype.matches:Element.prototype.webkitMatchesSelector?Element.prototype.webkitMatchesSelector:Element.prototype.msMatchesSelector,!i)?null:(r=function(n,t){var r=n;do{if(i.call(r,t))return r;r=r.parentElement||r.parentNode}while(r&&r.nodeType===1);return null},r(n,t))}function s(n){return n&&n.tagName==="A"}function t(n,t,i){n&&t&&i&&n.addEventListener(t,i)}function h(n,i){t(n,"keydown",function(n){n.keyCode==13&&i(n)})}function rt(n,i,r,u){if(r===void 0&&(r=!0),u===void 0&&(u=!0),n&&i){var f=s(n)?i:function(n){u&&(sj_pd(n),n.stopImmediatePropagation());i(n)};t(n,"click",f);r&&h(n,f)}}function ut(t,i){t&&i&&c(t,n.FocusInEN,i)}function ft(t,i){t&&i&&c(t,n.FocusOutEN,i)}function c(n,i,u){n&&u&&r(i,function(i){t(n,i,u)})}function l(t,i){if(!t||!i)return!1;var r=t[n.ClassListAttr];return r&&r.contains(i)}function a(t,i,r){t&&t[n.ClassListAttr]&&t[n.ClassListAttr][r](i)}function v(n,t){a(n,t,"add")}function u(n,t){a(n,t,"remove")}function f(n,t,i){n&&(v(n,i),u(n,t))}function et(t){t&&f(t,n.InProgressCN,n.FlyoutErrorCN)}function ot(t){t&&f(t,n.FlyoutErrorCN,n.InProgressCN)}function st(t){t&&u(t,n.InProgressCN)}function ht(n,t){var i,r,u;if(!(t&&t.content&&n))return!1;i=t.content;switch(i._type){case"ImageObject":return i.imageId===n.MediaId;case"VideoObject":return i.videoId===n.MediaId;case"GenericItem":if(n.ItemTagPath!==i.itemTagPath)return!1;if("contentId"in i&&"ContentId"in n)return i.contentId===n.ContentId;if(n.ClickThroughUrl!==i.url)return!1;if("CustomData"in n&&"customData"in i)try{if(r=JSON.parse(n.CustomData),u=JSON.parse(i.customData),"MediaUrl"in r||"MediaUrl"in u)return r.MediaUrl===u.MediaUrl}catch(f){return!1}return!0}return!1}function ct(n,t){var r=this,i;return t===void 0&&(t=300),function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];sb_ct(i);i=sb_st(function(){n.apply(r,f)},t)}}function lt(t){var i;if(!t)return"";if(t.turl)return t.turl;if(i=t.ThumbnailInfo,i&&i.length>=1){var r=i[0],u=r.Thumbnail,f=r.ThumbnailId,e=r.ExternalThumbnailUrl;return u||"".concat(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.bngd,"/th?id=").concat(f)||e}return""}n.isSavableEntity=y;n.getUrlParamsForTelemetry=p;n.elementsFromPoint=i;n.iterateThroughList=r;n.parseJsonString=w;n.iterateOverObject=e;n.objectAssign=b;n.fireOverlapping=k;n.elementContains=d;n.getClientRect=o;n.isElementInSpaceOfAnother=g;n.isCollectionExists=nt;n.getClosest=it;n.isAnchorElement=s;n.addListenerToElement=t;n.addEnterKeyListener=h;n.addClickListener=rt;n.addInListeners=ut;n.addOutListeners=ft;n.elementHasClass=l;n.addElementClass=v;n.removeElementClass=u;n.switchElementClass=f;n.switchElementToErrorClass=et;n.switchElementToInProgressClass=ot;n.removeInProgress=st;n.isDataPointingToSameItem=ht;n.debounce=ct;n.getThumnailFromItemMD=lt}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){if(n.itemSchema||(n.itemSchema={}),t&&t.length>0){var i=t.split(":"),r=i[0],u=i[1];n.itemSchema[r]=u}}function i(t){var i;if(!t)return null;if(i=t.dataset,i){var r=i.svptnk,u=i.svptnerinfo,f=i.svitminfp,e=i.svcptid,o=i.ufmc,s=i.sfmc,h=i.svstb,c=i.svmdcmp,l=i.svloc,a=i.svattr,v=i.persbtncls,y=i.cstmuiobj,p=n.parseJsonString(u)||{},w=n.parseJsonString(y)||{};return n.objectAssign(n.parseJsonString(f)||{},{PredefinedType:p,Key:r,ComponentId:e,UnsavedFormCode:o,SavedFormCode:s,SavedLinkSameTab:!!h,MetaLocInfo:{MetadataLocationId:l,MetadataLocationAttr:a,MetaLocCompName:c},PersButtonClassName:v,CustomUIObj:w})}}function r(){if(n.singlePartner){var u=n.singlePartner.Mapping,f=n.singlePartner.SavedFormCode,e=n.singlePartner.SavedLinkSameTab,i=n.singlePartner.PredefinedType,o=i.Title,s=i.CollectionTagPath,r=i.PredefinedCollectionType,h=i.ItemType,c=i.APIItemType,l=n.singlePartner.Key,a=n.singlePartner.SourceAttr,v=n.singlePartner.ItemTagPath,y=n.singlePartner.AttachToElementSelector,p=n.singlePartner.AttachDelay,w=n.singlePartner.ComponentId,b=n.singlePartner.PersButtonClassName,k=n.singlePartner.CustomUIObj;u&&n.iterateThroughList(u.split(","),t);h&&(n.defaultItemType=h);l&&(n.partnerKey=l);r&&(n.defaultCollectionType=r,n.defaultCollectionId=Constants.PredefinedCollections[r]);o&&(n.defOrCustCollName=o);s&&(n.collTagPath=s);v&&(n.itemTagPath=v);w&&(n.compName=w);a&&(n.sourceAttribute=a);c&&(n.apiItemType=c);y&&(n.attachElementSelector=y,p&&(n.attachDelay=p));f&&(n.savedFormCode=f);e&&(n.savedLinkSameTab=e);n.apiItemType&&n.compName&&(n.urlParams=n.getUrlParamsForTelemetry(n.apiItemType,n.compName));b&&(n.persistentButtonClassName=b);k&&(n.customUIObj=k)}}function u(t,u){var f=t&&t.getAttribute("data-svcptid"),e;f&&!n.componentMap[f]&&(e=i(t),n.componentMap[f]=e,n.partnerCount++,n.partnerCount===1&&(n.singlePartner=e,r()));u&&u(t)}n.componentMap={};n.partnerCount=0;n.registerPartnerAndComponent=u}(SvCtrlV2||(SvCtrlV2={})),function(n){function nt(i){var u={ItmId:n.currentElementMid,CompName:n.currentCompName};t(r,y,u,MMInstUtils.getInstKData(i))}function tt(){var i={CompName:n.currentCompName,HvrSrc:g};t(f,"",i)}function it(){var i={CompName:n.currentCompName,HvrSrc:h};t(f,"",i)}function rt(i){var r={ColCount:i,CompName:n.currentCompName};t(u,a,r)}function ut(){var i={CompName:n.currentCompName};t(u,v,i)}function ft(r,u){var f={ColId:u,CollName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:w};t(i,"",f,MMInstUtils.getInstKData(r))}function et(r){var u={CompName:n.currentCompName,ClkSrc:b};t(i,"",u,MMInstUtils.getInstKData(r))}function ot(r,u){var f={ColId:u,ColName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:p};t(i,"",f,MMInstUtils.getInstKData(r))}function st(r){var u={CompName:n.currentCompName,Clksrc:k};t(i,"",u,MMInstUtils.getInstKData(r))}function ht(r){var u={CompName:n.currentCompName,Clksrc:h};t(i,"",u,MMInstUtils.getInstKData(r))}function ct(i,u,f,e,s){var h={ColId:s,ItmId:u,CompName:n.currentCompName,ClkSrc:f,IsNewCol:e?"1":"0"};t(r,o,h,MMInstUtils.getInstKData(i))}function lt(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(e,o,r,MMInstUtils.getInstKData(i))}function at(i,u,f,e){var o={ColId:u,ItmId:f,CompName:n.currentCompName,ClkSrc:e};t(r,s,o,MMInstUtils.getInstKData(i))}function vt(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(e,s,r,MMInstUtils.getInstKData(i))}function yt(i,r){var u={CompName:n.currentCompName,ErrorType:r};t(c,d,u,MMInstUtils.getInstKData(i))}function t(n,t,i,r){t===void 0&&(t="");i===void 0&&(i=null);r===void 0&&(r=null);MMInstUtils.logEvent(n,l,t,i,r)}var u="CI.Saves",f="CI.Hover",i="CI.SaveClick",r="CI.Success",e="CI.Failure",c="CI.SaveErr",l="SaveControl",o="Saved",s="Unsaved",a="GetCollections",v="GetCollFailed",y="ShowFlyout",p="LnkClk",w="ColLst",b="CrtNewBtn",k="ColExp",h="SvCtrlBtn",d="UIState",g="Flyout";n.logFlyoutShown=nt;n.logFlyoutHoverEvent=tt;n.logSvBtnHoverEvent=it;n.logGetCollectionsSucceeded=rt;n.logGetCollectionsFailed=ut;n.logCollLstClick=ft;n.logCreateButtonClick=et;n.logLinkClick=ot;n.logCollExpandClick=st;n.logSaveControlBtnClick=ht;n.logAddItemSucceeded=ct;n.logAddItemFailed=lt;n.logDeleteItemSucceeded=at;n.logDeleteItemFailed=vt;n.logErrorState=yt}(SvCtrlV2||(SvCtrlV2={})),function(n){function e(n){wt=n}function o(){return wt}function et(t){n.removeElementClass(n.currentHoveredElement,n.CurrentElementCN);n.currentElementMid=null;n.currentElementCollId&&(sj_evt.fire("onCurrentCollIdUnset",n.currentElementCollId),n.currentElementCollId=null);t?v(t):(n.currentHoveredElement=null,n.currentElementTurl=null,n.currentElementMetadata=null)}function f(t,i){var r,u;return(i===void 0&&(i=n.sourceAttribute),!t)?null:(r=t.hasAttribute(i)?t:ui(t,i),!r)?null:(u=r.getAttribute(i),!u)?null:n.parseJsonString(u)}function hr(){if(n.currentElementTemp){var t=n.currentElementTemp;return n.currentElementTemp=null,t}}function ti(n){var r,t,i,u,f;if(n&&n.items){for(r=n.items,t=r.length-1;t>=0;t--)if(i=r[t],i&&i.content){if(u=i.content,!u)continue;if(f=oi(u),f)return f}return null}}function s(n){if(n){var t=n.mid,i=n.sid;return t||i}}function ot(i,e,o,h){var a,c,l,p;if(e===void 0&&(e=n.currentHoveredElement),h===void 0&&(h=n.sourceAttribute),a=1,c=e||n.currentHoveredElement,c){var v=i in Constants.PredefinedCollections,w=v?Constants.PredefinedCollections[i]:null,k=n.localCollectionsMap[i],y=function(t,u,f){return(f===void 0&&(f=null),!(t&&t[n.IsSuccessAttr]))?!1:(i&&!r&&(n.latestCollId=i),sj_evt.fire(n.CurrentCollIdSetEN,i),ht(),hi(f,c,t,u,o,k,i,!1))},b=n.currentUrlParams;if(c.hasAttribute(n.SavesGenericItemDataAttr)&&typeof t.addEdgeGenericItem!==n.UndefinedString)t.addEdgeGenericItem(n.parseJsonString(c.getAttribute(n.SavesGenericItemDataAttr)),i,function(t){return y(t,!0,n.currentElementMid)},function(){return u(a)},n.currentCompName);else{if(l=f(c,h),!l){u(7);return}p=s(l);vt(l)&&typeof t.addGenericItem!==n.UndefinedString?t.addGenericItem(b,l,n.itemSchema,n.itemTagPath,v?w:null,n.localCollectionsMap[i],i,n.partnerKey,null,function(n){return y(n,!0,p)},function(){return u(a)}):typeof t.addNonGenericItem!==n.UndefinedString&&t.addNonGenericItem(b,l,n.defaultItemType,n.itemSchema,i,v?w:null,n.localCollectionsMap[i],function(n){return y(n,!1,p)},function(){return u(a)})}}}function ii(i,e,o,h){var v=1,l=e||n.currentHoveredElement,a,y,c,b,p;if(l)if(a=function(t,u,f){var s,h,e;return(f===void 0&&(f=null),!(t&&t[n.IsSuccessAttr]))?!1:(e=(h=(s=t.targetCollectionOperationStatus)===null||s===void 0?void 0:s.collection)===null||h===void 0?void 0:h.id,e)?(w(e,i),r||(n.latestCollId=e),sj_evt.fire(n.CollRegisterEN,!0,e,i,n.currentElementTurl,null,!0),o&&o(t),ht(),hi(f,l,t,u,"Flyt",i,e,!0)):!1},y=n.currentUrlParams,l.hasAttribute(n.SavesGenericItemDataAttr)&&typeof t.addEdgeGenericItemToNewColl!==n.UndefinedString)t.addEdgeGenericItemToNewColl(n.parseJsonString(l.getAttribute(n.SavesGenericItemDataAttr)),i,function(n){return a(n,!0)},function(){return u(v)},n.currentCompName);else{if(c=f(l),b=function(){u(7);h()},!c){b();return}p=s(c);vt(c)&&typeof t.addGenericItem!==n.UndefinedString?t.addGenericItem(y,c,n.itemSchema,n.itemTagPath,null,i,null,n.partnerKey,n.collTagPath,function(n){return a(n,!0,p)},function(){return u(v)}):i&&typeof t.addNonGenericItem!==n.UndefinedString&&t.addNonGenericItem(y,c,n.defaultItemType,n.itemSchema,null,null,i,function(n){return a(n,!1,p)},function(){return u(v)})}}function st(i,f,e){var v=2,s=e||n.currentHoveredElement,h,o,c,l,a;s&&(h=n.currentElementMid,o=n.localSavedItemsMap[h],o)&&(c=function(t){return r||(n.latestCollId=i),sj_evt.fire("onCurrentCollIdUnset",i),ht(),yr(h,s,t,f,o.cid||null,i)},l=n.currentUrlParams,(s.hasAttribute(n.SavesGenericItemDataAttr)||n.currentElementMetadata&&vt(n.currentElementMetadata))&&typeof t.deleteGenericItem!==n.UndefinedString?t.deleteGenericItem(l,o.cid,n.kctColls[i]||i,c,function(){return u(v)}):typeof t.deleteNonGenericItem!==n.UndefinedString&&(a=i in Constants.PredefinedCollections,t.deleteNonGenericItem(l,a?Constants.PredefinedCollections[i]:"",a?"":i,o.cid,n.defaultItemType,c,function(){return u(v)})))}function cr(t,i,u,f){var s,e=f||n.currentHoveredElement,o;if(e){if(n.logSaveControlBtnClick(e),sj_evt.fire("onSaveInProgress",e),t==n.CustomCollDummyId){ii(n.defOrCustCollName,n.currentHoveredElement,function(){n.removeCollectionFromPicker(n.CustomCollDummyId)});return}o=n.elementHasClass(e,n.SavedCN)||n.elementHasClass(n.hoverContainerSub,n.SavedCN);!o&&(n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentElementMid])&&(o=!0);r?((s=n.localSavedItemsMap[n.currentElementMid])===null||s===void 0?void 0:s.collections[n.latestCollId])?st(t,i):ot(t,e,i):o?u&&st(t,i):ot(t,e,i)}}function ht(){i&&i.broadcastMessage(i.BCActionMessage)}function ct(t,i,r,u,f){n.standalone&&sj_evt.fire(n.scEngagementEN,t,i,r,u,f)}function ri(t){var i,r,u;if(c)for(i in n.localSavedItemsMap)if(r=n.localSavedItemsMap[i],r.rawItem&&(u=r.rawItem,n.isDataPointingToSameItem(t,u)))return i;return null}function v(t,i,u,e){var c,o,h;i===void 0&&(i=n.sourceAttribute);u===void 0&&(u=n.urlParams);e===void 0&&(e=n.compName);n.addElementClass(t,n.CurrentElementCN);n.currentHoveredElement=t;o=f(t,i)||f(t,n.SavesGenericItemDataAttr);o&&(n.currentElementMetadata=o,n.currentElementMid=s(o)||ri(o),n.currentElementTurl=n.getThumnailFromItemMD(o),h={},n.currentElementMid?((n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentElementMid])?(n.currentElementCollId=n.localSavedItemsMap[n.currentElementMid].lastCollection,n.currentElementCollId&&sj_evt.fire(n.CurrentCollIdSetEN,n.currentElementCollId),h=n.localSavedItemsMap[n.currentElementMid].collections,(!r||((c=n.localSavedItemsMap[n.currentElementMid])===null||c===void 0?void 0:c.collections[n.latestCollId]))&&(n.addElementClass(t,n.SavedCN),n.addElementClass(n.hoverContainerSub,n.SavedCN))):n.removeElementClass(n.hoverContainerSub,n.SavedCN),sj_evt.fire(n.HoverElementSetEN,h)):(n.removeElementClass(n.hoverContainerSub,n.SavedCN),n.removeElementClass(t,n.SavedCN),sj_evt.fire(n.HoverElementSetEN,h)));n.currentUrlParams=u;n.currentCompName=e}function lt(t){var i,r;return t?(i=n.defaultItemType in n.TypeToAttributeMap?n.TypeToAttributeMap[n.defaultItemType]:null,!i)?t:(r=n.defaultItemType+":"+i+"=",(t.indexOf(r)!==0?r:"")+t):null}function ui(n,t){return n?_qs("["+t+"]",n):null}function y(t){var r=ui(n.containerElement,n.sourceAttribute+'*="'+t+'"'),i;if(!r)return null;for(i=r;!n.isSavableEntity(i)&&i[n.ParentElementAttr];)i=i[n.ParentElementAttr];return n.isSavableEntity(i)?i:r}function p(t,i,u,f,e,o){var s;if(t&&i){if(!(i in n.localSavedItemsMap)){n.elementHasClass(t,n.SavedCN)&&n.removeElementClass(t,n.SavedCN);return}(!r||((s=n.localSavedItemsMap[n.currentElementMid])===null||s===void 0?void 0:s.collections[n.latestCollId]))&&n.addElementClass(t,n.SavedCN);u&&(t&&sj_evt.fire("Saved",t),n.logAddItemSucceeded(t,i,f,e,o))}}function at(t,i,u,f,e){var o;t&&i&&(i in n.localSavedItemsMap&&(!r||((o=n.localSavedItemsMap[n.currentElementMid])===null||o===void 0?void 0:o.collections[n.latestCollId]))||n.removeElementClass(t,n.SavedCN),u&&(t&&sj_evt.fire("Unsaved",t),n.logDeleteItemSucceeded(t,e||it,i,f)))}function fi(t,i,r,u,f){var e,o;t&&(t in n.localSavedItemsMap?(u&&n.localSavedItemsMap[t].lastCollection||(n.localSavedItemsMap[t].lastCollection=r),n.localSavedItemsMap[t].collections[r]||(n.localSavedItemsMap[t].collections[r]=!0,n.localSavedItemsMap[t].numCollections++),u?n.localSavedItemsMap[t].collectionQueue.unshift(r):n.localSavedItemsMap[t].collectionQueue.push(r)):(o={cid:f?i:lt(i),rawItem:f?f:null,collections:(e={},e[r]=!0,e),lastCollection:r,collectionQueue:[r],numCollections:1},n.localSavedItemsMap[t]=o))}function ei(t,i){if(t&&n.localSavedItemsMap[t])if(it=i,n.localSavedItemsMap[t].numCollections===1)delete n.localSavedItemsMap[t],n.currentElementMid===t&&(n.currentElementCollId=null);else{delete n.localSavedItemsMap[t].collections[i];n.localSavedItemsMap[t].numCollections--;var r=n.localSavedItemsMap[t].collectionQueue.indexOf(i);r>-1&&(n.localSavedItemsMap[t].collectionQueue.splice(r,1),n.localSavedItemsMap[t].lastCollection=n.localSavedItemsMap[t].collectionQueue.slice(-1)[0],n.currentElementMid===t&&(n.currentElementCollId=n.localSavedItemsMap[t].lastCollection))}}function lr(t,i){t&&(n.switchElementToErrorClass(t),sj_evt.fire(n.SaveControlErrorEN,i))}function oi(n){var t,i;return n.thumbnailUrl||((i=(t=n.thumbnails)===null||t===void 0?void 0:t[0])===null||i===void 0?void 0:i.thumbnailUrl)}function si(t,i,r,u){n.localCollectionsCidMap[t]||(n.localCollectionsCidMap[t]=[]);n.localCollectionsCidMap[t].indexOf(i)<=-1&&(u?n.localCollectionsCidMap[t].push(i):n.localCollectionsCidMap[t].unshift(i));n.cidToThumbnailUrlMap[i]||(n.cidToThumbnailUrlMap[i]=r)}function ar(t,i){var r,u;if(n.localCollectionsCidMap[t])return(u=n.localCollectionsCidMap[t].indexOf(i),u<=-1)?void 0:(n.localCollectionsCidMap[t].splice(u,1),((r=n.localCollectionsCidMap[t])===null||r===void 0?void 0:r[0])||null)}function vr(t,i){var r,u;return t?(r=n.parseJsonString(t.getAttribute(n.SavesGenericItemDataAttr)),r||(r=f(t,n.sourceAttribute)),!r)?null:(u={url:r.ClickThroughUrl,customData:r.CustomData,domain:r.FriendlyDomainName,itemTagPath:r.ItemTagPath,title:r.Title,_type:"GenericItem",contentId:r.ContentId},{collectionItemId:i,content:u,itemtype:"Generic"}):null}function hi(t,i,u,f,e,o,s,h){var v=u.targetCollectionOperationStatus,w,c,b,k,tt,it;if(!(v&&v[n.IsSuccessAttr]))return!1;try{var d=v,g=d.itemOperationStatuses,rt=n.CollectionAttr,a=d[rt];if(!(g&&a&&a.id))return!1;var ut=g,nt=ut[0],ft=n.IsSuccessAttr,et=nt[ft],ot=n.CollectionItemIdAttr,l=nt.item[ot];return et?(w=s in Constants.PredefinedCollections,c=w?s:a.id,r||(n.latestCollId=c),w&&(n.kctColls[s]=a.id),t||n.currentElementMid!==null||l===null||(b=l.substring(l.indexOf(":")+1),t=b,n.currentElementMid=b),!t&&n.currentElementMid&&(t=n.currentElementMid),k=f?l:lt(l),si(c,k,n.currentElementTurl,!1),n.localCollectionsMap[c]&&sj_evt.fire("onChangeCollThumbnail",c,n.currentElementTurl),tt=t?n.localSavedItemsMap[t]:!1,it=f?vr(i,l):null,fi(t,k,c,!1,it),n.localSavedItemsMap[t]&&ct(1,0,h?1:0,n.localSavedItemsMap[t].numCollections),i)?(p(i,t,!0,e,h,c),sj_evt.fire(n.UpdateHoverBoxEN,c,n.localCollectionsMap[c],t&&n.localSavedItemsMap[t].numCollections||1),n.isSavableEntity(i)||p(y(t),t,!1),ci(n.SaveAddEN,u,t,i,!tt)):!1:!1}catch(st){return!1}}function yr(t,i,r,u,f,e){var s,o;return(r&&r[n.IsSuccessAttr])?(r.collectionId=e,ei(t,e),ct(0,1,0,n.localSavedItemsMap[t]?n.localSavedItemsMap[t].numCollections:0),i)?(at(i,t,!0,u,e),s=ar(e,f),sj_evt.fire("onChangeCollThumbnail",e,s?n.cidToThumbnailUrlMap[s]:null),o=!n.localSavedItemsMap[t],o&&!n.isSavableEntity(i)&&at(y(t),t,!1),sj_evt.fire(n.UpdateHoverBoxEN,e,n.localCollectionsMap[e],o?0:n.localSavedItemsMap[t].numCollections),ci(n.SaveDelEN,r,t,i,o)):!1:!1}function ci(t,i,u,f,e){var o;if(f){if(n.removeInProgress(f),n.currentHoveredElement===f){n.removeElementClass(n.ctrl,n.GetErrCN);switch(t){case n.SaveAddEN:(!r||((o=n.localSavedItemsMap[n.currentElementMid])===null||o===void 0?void 0:o.collections[n.latestCollId]))&&n.addElementClass(n.hoverContainerSub,n.SavedCN);break;case n.SaveDelEN:e&&n.removeElementClass(n.hoverContainerSub,n.SavedCN)}n.removeInProgress(n.hoverContainerSub)}sj_evt.fire(t,i,u,f,e,typeof n.metaLocElement!==n.UndefinedString&&n.metaLocElement===f)}return it=null,!0}function vt(t,i){return i===void 0&&(i=n.defaultItemType),!("mid"in t)&&i!=="recipe"}function u(t){n.currentHoveredElement&&(lr(n.currentHoveredElement,t),t==1?n.logAddItemFailed(n.currentHoveredElement):t==2&&n.logDeleteItemFailed(n.currentHoveredElement))}function pr(){n.logGetCollectionsFailed();n.addElementClass(n.ctrl,n.GetErrCN);sj_evt.fire(n.SaveControlErrorEN,3);rt=!1}function wr(t){n.logGetCollectionsSucceeded(t)}function br(n){if(!(n&&n.content&&n.itemType))return null;var t=n.content,i=n.itemType;switch(i){case"Image":return t.imageId;case"Video":return t.videoId;case"Generic":return t.contentId;default:return null}}function kr(t){if(!t)return null;var u=t&&t[n.CollectionItemIdAttr],i=u?decodeURIComponent(u):"",r=br(t);return r||(r=/^[a-z]+:[a-z]+=/.test(i)?i.substring(i.indexOf("=")+1):i.replace("/"+n.partnerKey+"/:","")),{contentId:r,collectionItemId:i}}function w(t,i){n.localCollectionsMap[t]=i;n.localCollectionNames[i]=1}function dr(t){if(!(t.length<=0)){var r=t.sort(function(n,t){return n.dateModified>t.dateModified?-1:1}),i=r[0];n.latestCollId=!i.knownCollectionType?i.id:Constants.PredefinedCollections[i.knownCollectionType]}}function gr(n,t){var r=t[0];if(n){var u=kr(n),i=u.collectionItemId,f=u.contentId;f&&i&&(n.content&&si(r,i,oi(n.content),!0),fi(f,i,r,!0,n.itemType=="Generic"?n:null))}}function nu(t){var u,e;if(t){var r=t.collectionPage,f=t.id,i=t.knownCollectionType;(i&&(n.kctColls[Constants.PredefinedCollections[i]]=f),u=!i?f:Constants.PredefinedCollections[i],n.localCollectionsMap[u]||yu(t),r&&r.items)&&(e=r.items,n.iterateThroughList(e,gr,u))}}function tu(t){var i,r;return(t&&t.collections)?(i=t.collections,i=i.reverse(),r=(i===null||i===void 0?void 0:i.length)||0,wr(r),n.iterateThroughList(i,nu),dr(i),sj_evt.fire("onSaveGet",t),c||(c=!0,l&&(v(l),l=null)),n.defaultCollectionType&&!n.localCollectionsMap[n.defaultCollectionId]&&(w(n.defaultCollectionId,n.defOrCustCollName),n.latestCollId||(n.latestCollId=n.defaultCollectionId),sj_evt.fire(n.CollRegisterEN,!1,n.defaultCollectionId,n.defOrCustCollName,null,n.defaultCollectionType)),!n.defaultCollectionType&&n.collTagPath&&n.defOrCustCollName&&!n.isCollectionExists(n.defOrCustCollName)&&(n.latestCollId=n.CustomCollDummyId,sj_evt.fire(n.CollRegisterEN,!1,n.CustomCollDummyId,n.defOrCustCollName)),n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner),sj_evt.fire("onCollectionsGotten"),!0):!1}function iu(t,i){n.hoverContainer&&n.hoverContainer.style.setProperty(t,i)}function li(t){n.hoverContainerSub&&n.removeElementClass(n.hoverContainerSub,t)}function yt(t){n.hoverContainer&&t&&n.iterateOverObject(t,iu)}function ai(t){n.hoverContainer&&yt({display:t})}function ru(n){ni=new Date;ut===!1&&(ut=!0,setTimeout(function(){return vi(n)},ft))}function vi(t){var u=new Date,i,r;u.getTime()-ni.getTime()<ft?setTimeout(function(){return vi(t)},ft):(ut=!1,i=_qs("."+n.persistentButtonClassName,_d.body),(t===null||t===void 0?void 0:t.type)==="resize"&&i&&n.elementHasClass(n.hoverContainerSub,"b_scpers")?(r=n.getClientRect(i),yt({top:r.top+n.PixelUnit,left:r.left+n.PixelUnit})):h())}function h(t){var r=t||n.currentHoveredElement,i;if(n.hoverContainer&&r){if(e(!0),pu(),i=n.getClientRect(r),!i){e(!1);return}var u=i.top,f=i.bottom,o=i.left,s=i.width,h=i.height,c=f>_w.innerHeight?_w.innerHeight-u:h;yt({width:s+n.PixelUnit,height:c+n.PixelUnit,top:u+dt+n.PixelUnit,left:o+kt+n.PixelUnit});e(!1)}}function yi(){n.hoverContainer&&ai("block")}function b(){n.hoverContainer&&(ai("none"),sj_evt.fire("onHoverContainerHide"))}function uu(t){var i=n.currentHoveredElement;i&&n.hoverContainerSub&&(n.elementHasClass(i,t)?n.addElementClass(n.hoverContainerSub,t):li(t))}function fu(){if(!o()){var t=pi(null);t&&(et(t),n.hoverContainer&&(h(),yi(),n.removeElementClass(n.hoverContainerSub,"b_scpers"),n.iterateThroughList(n.RemovableCN,uu)),sj_evt.fire(n.ControlAppendedEN))}}function eu(t){if(!o()){var i=t[n.RelatedTargetAttr];if(i||b(),i&&n.hoverContainer){if(n.elementContains(n.ctrl,i))return;n.isElementInSpaceOfAnother(i,n.hoverContainer)||b()}}}function pi(n){nt&&sb_ct(nt);var t=bt;return bt=n,n&&(nt=sb_st(fu,sr*2)),t}function ou(t){if(!o()){var i=t[n.CurrentTargetAttr];n.currentFocusTarget=t.target;i&&n.isSavableEntity(i)?pi(i):sj_pd(t)}}function su(t){var i,r,f,u,e;if(!o()){if(i=t[n.CurrentTargetAttr],r=t[n.RelatedTargetAttr],!r){if(f=t[n.TargetAttr],t.type!=="mouseleave"&&n.elementContains(i,f))return;b();return}if(!n.elementContains(n.ctrl,r)&&n.isSavableEntity(i)&&!n.elementContains(i,r)){for(u=r;!n.isSavableEntity(u)&&u[n.ParentElementAttr];)u=u[n.ParentElementAttr];if(e=n.isSavableEntity(u),t.type==="focusout"&&!n.elementContains(i,r)&&!n.shiftKeyDown&&n.tabKeyDown&&e){n.nextFocusable=r;n.ctrlBtn.focus();sj_evt.fire(n.SaveButtonFocusEN);n.tabKeyDown=!1;return}n.hoverContainer&&b();n.iterateThroughList(n.RemovableCN,li);n.iterateThroughList([n.HoverCN,n.FocusCN,n.SaveCtrlHoveredCN,n.CurrentElementCN],function(t){n.removeElementClass(i,t)});n.currentHoveredElement===i&&(et(),n.currentFocusTarget==null)}}}function wi(t){t&&(n.addInListeners(t,ou),n.addOutListeners(t,su),n.isSavableEntity(t)&&ki(t))}function k(n,t,i){return(i===void 0&&(i=""),n&&n.children&&t)?n.querySelectorAll("."+t+i):[]}function bi(t){return t?k(t,n.SavableEntityCN):[]}function d(t){if(t){if(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.bclist){var i=n.ctrl.dataset.bclist.toLowerCase().split(",");if((i===null||i===void 0?void 0:i.indexOf(n.compName===null||n.compName===void 0?void 0:n.compName.toLowerCase()))>-1)return}n.isSavableEntity(t)?wi(t):n.iterateThroughList(bi(t),wi)}}function ki(n){if(n){var t=f(n);t&&p(n,s(t)||ri(t))}}function hu(t){var i=t;i&&(i.type==="attributes"&&i.target&&n.iterateThroughList(bi(i.target),function(n){d(n);ki(n)}),n.ctrl&&i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,d))}function cu(i){n.partnerCount!==1||rt?(a.observe(i,g),n.ctrl&&d(i)):(n.containerElement=i,typeof t.getCollections!==n.UndefinedString&&(t.getCollections(n.urlParams,function(n){return lu(n,i)},pr),rt=!0))}function lu(t,i){var r=tu(t);return a.observe(i,g),n.ctrl&&d(i),r}function au(t){for(var i=t,u={scroll:1,overlay:1,auto:1},r;i&&i.parentElement&&i!==(_d===null||_d===void 0?void 0:_d.body);){if(i.hasAttribute(n.ScrollBindDataAttr))break;r=_w===null||_w===void 0?void 0:_w.getComputedStyle(i);(r.overflow in u||r.overflowX in u||r.overflowY in u)&&(n.addListenerToElement(i,"scroll",function(){h()}),i.setAttribute(n.ScrollBindDataAttr,"1"));i=i.parentElement}}function di(t){n.registerPartnerAndComponent(t,cu);(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.cstmui)&&bu();au(t)}function gi(t){var r,i,u,f;if(t&&(n.elementHasClass(t,n.SaveCtrlContainerCN)?t.dataset.svcptid&&di(t):n.elementHasClass(t,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner),r=t.children,r))for(i=0,u=r;i<u.length;i++)f=u[i],gi(f)}function vu(t){var i=t;i&&(i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,gi),i.removedNodes&&i.removedNodes.length>0&&n.iterateThroughList(i.removedNodes,function(t){n.elementHasClass(t,n.persistentButtonClassName)&&sj_evt.fire(n.DeregisterPersBtnEN)}),i.attributeName&&i.target&&n.elementHasClass(i.target,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner))}function pt(t){t&&n.iterateThroughList(t,di)}function nr(t){return new MutationObserver(function(i){return n.iterateThroughList(i,t)})}function tr(n){var t=n[1],i=n[2],u,r;t&&i&&(u=i&&lt(i),u)&&(r=y(t),r&&p(r,t,!1))}function ir(n){var t=n[1],r=n[2],i;t&&(i=y(t),ei(t,r),i&&at(i,t,!1))}function yu(t,i){var f,r;i===void 0&&(i=!1);var h=t.id,e=t.title,o=t.collectionPage,s=t.knownCollectionType,u=s?Constants.PredefinedCollections[s]:h;!n.localCollectionsMap[u]&&e&&(w(u,e),r=null,o&&((f=o.items)===null||f===void 0?void 0:f.length)&&(r=ti(o),r&&sj_evt.fire("onChangeCollThumbnail",u,r)),sj_evt.fire(n.CollRegisterEN,i,u,e,r,s||null))}function pu(){kt=_w.scrollX||_w.pageXOffset;dt=_w.scrollY||_w.pageYOffset}function rr(){(n.flyoutContainer===null||n.flyoutContainer===void 0?void 0:n.flyoutContainer.dataset.ebc)&&typeof CollChannel.CollectionsBroadcastChannel!="undefined"&&(i=new CollChannel.CollectionsBroadcastChannel(ku,null,null,!1),i===null||i===void 0?void 0:i.initialize())}function ur(t){var i=t[1],r=t[2],u=t[3],f=t[4],e=t[5];v(r,u,f,e);h(i);yi();n.addElementClass(n.hoverContainerSub,"b_scpers");sj_evt.fire(n.ControlAppendedEN)}function wu(){var t=_d.querySelector(":root"),i,r;t&&(t.style.setProperty(n.IcnsBGColorCss,n.SavePromClrCss),t.style.setProperty(n.IcnLblTxtClrCss,n.SavePromTxtClrCss),i=getComputedStyle(t).getPropertyValue(n.SavedPromIcnCss),t.style.setProperty(n.SavedIcnCss,i),r=getComputedStyle(t).getPropertyValue(n.UnsavedPromIcnCss),t.style.setProperty(n.UnsavedIcnCss,r))}function bu(){n.customUIObj&&n.flyoutContainer&&(n.customUIObj.BGColor&&n.flyoutContainer.style.setProperty(n.FlyoutBGClrCss,n.customUIObj.BGColor),n.customUIObj.TextColor&&n.flyoutContainer.style.setProperty(n.FlyoutTxtClrCss,n.customUIObj.TextColor),n.customUIObj.LinkColor&&n.flyoutContainer.style.setProperty(n.FlyoutLnkClrCss,n.customUIObj.LinkColor))}function ku(){return}function fr(t){var i=t[1];pt(k(_d.body,n.SaveCtrlContainerCN));c?v(i):l=i}function er(){pt(k(_d.body,n.SaveCtrlContainerCN));n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner)}function or(){sj_evt.unbind(n.FavAddEN,tr);sj_evt.unbind(n.FavDeleteEN,ir);sj_evt.unbind("ajax.unload",or);sj_evt.unbind(n.PersButtonInteractEN,ur);sj_evt.unbind(n.CollBCLoadedEN,rr);sj_evt.unbind(n.CurrentElementSetEN,fr);sj_evt.unbind(n.UpdateSaveStateEN,er);_d.body.removeChild(n.hoverContainer);tt.disconnect();a.disconnect();i===null||i===void 0?void 0:i.close()}function du(){sj_evt.bind(n.FavDeleteEN,ir);sj_evt.bind(n.FavAddEN,tr);sj_evt.bind(n.PersButtonInteractEN,ur);sj_evt.bind("ajax.unload",or);sj_evt.bind(n.CurrentElementSetEN,fr,!0);sj_evt.bind(n.UpdateSaveStateEN,er,!0);sj_evt.bind(n.CollBCLoadedEN,rr,!0)}function gu(){var t;n.ctrl=_ge("svctrl");n.ctrl&&(e(!1),n.addListenerToElement(n.ctrl,"mousedown",sj_sp));n.ctrlBtn=_ge("svctrlbtn");n.hoverContainer=_ge("svhvr");n.hoverContainerSub=_ge("svhvrsub");n.hoverContainer&&(_d.body.insertBefore(n.hoverContainer,_d.body.firstChild),n.addOutListeners(n.hoverContainer,eu));n.localSavedItemsMap={};n.localCollectionsMap={};n.localCollectionsCidMap={};n.cidToThumbnailUrlMap={};n.localCollectionNames={};n.latestCollId=null;n.currentElementCollId=null;n.currentElementMid=null;n.partners=[];a=nr(hu);tt=nr(vu);tt.observe(_d.body,g);n.flyoutContainer=_ge("svflytc");n.flyoutContainer&&n.flyoutContainer.hasAttribute("data-svlne")&&(n.standalone=!!n.flyoutContainer.getAttribute("data-svlne"));n.standalone||pt(k(_d.body,n.SaveCtrlContainerCN));du();n.addListenerToElement(_w,n.ScrollEvent,h);n.addListenerToElement(_w,n.ResizeEvent,ru);gt=n.debounce(function(){n.tabKeyDown=!1},1e3);_w.addEventListener("keydown",function(t){!n.shiftKeyDown&&t.shiftKey?n.shiftKeyDown=!0:n.tabKeyDown||t.key!="Tab"||(n.tabKeyDown=!0)});_w.addEventListener("keyup",function(t){!t.shiftKey&&n.shiftKeyDown?n.shiftKeyDown=!1:n.tabKeyDown&&t.key=="Tab"&&gt()});(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.isprom)&&wu();r=(t=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset)===null||t===void 0?void 0:t.svctrlv3}var t=MySavesAPIUtils;n.containerElement=null;n.shiftKeyDown=!1;n.tabKeyDown=!1;n.kctColls={};var g={childList:!0,subtree:!0,attributes:!0},wt,c=!1,l=null,nt,tt,a,it,bt,sr=0,kt=0,dt=0,i,rt=!1,gt=null,r=null,ni,ut=!1,ft=500;n.setKeepFlyoutActive=e;n.getKeepFlyoutActive=o;n.clearCurrentHoveredElement=et;n.metadataFromElement=f;n.clearTempCurrentElement=hr;n.getThumbnailUrlFromCollectionPage=ti;n.getMetadataId=s;n.addToCollection=ot;n.addToNewCollection=ii;n.removeFromCollection=st;n.handleSaveClick=cr;n.fireSCEngagementEvent=ct;n.addCollectionName=w;gu()}(SvCtrlV2||(SvCtrlV2={})),function(n){function wt(t){if(i){t||(t=n.currentElementMid);var u=t&&n.localSavedItemsMap[t],e=r||!u,f=e?n.latestCollId:u.lastCollection,o=f&&n.localCollectionsMap[f]||n.defOrCustCollName;at(f,o,u?u.numCollections:0)}}function ct(t,i){if(t&&st!==t){n.removeElementClass(st,"b_sclbl");n.addElementClass(t,"b_sclbl");st=t;n.removeElementClass(pt,n.SublabelActiveCN);var r=t.querySelector(i?"onsvd":"onusvd");n.addElementClass(r,n.SublabelActiveCN);pt=r}}function si(t){sj_sp(t);var i=t.target.value.trim(),r=n.isCollectionExists(i);b.setAttribute("aria-disabled",i&&!r?"false":"true");r?n.addElementClass(l,n.ErrDispCN):n.elementHasClass(l,n.ErrDispCN)&&n.removeElementClass(l,n.ErrDispCN)}function bt(t){var i,r=t[1];at(r,n.localCollectionsMap[r],n.currentElementMid&&((i=n.localSavedItemsMap[n.currentElementMid])===null||i===void 0?void 0:i.numCollections))}function hi(t){var i=t[1];i==5?(n.removeElementClass(ft,n.errStateInvisibleCN),n.addElementClass(ft,n.errStateVisibleCN)):g&&(o.textContent=g[i],n.removeElementClass(o,n.errStateInvisibleCN),n.addElementClass(o,n.errStateVisibleCN));n.logErrorState(n.currentHoveredElement,n.UiErrorStates[i]);n.fireSCEngagementEvent(0,0,0,n.currentElementMid&&n.localSavedItemsMap[n.currentElementMid]?n.localSavedItemsMap[n.currentElementMid].numCollections:0,n.UiErrorStates[i]);p(e)}function ci(t){var i,u,s=t[0],e=t[1],o=t[2],f=t[3];f!==0&&(!r||((i=n.localSavedItemsMap[n.currentElementMid])===null||i===void 0?void 0:i.collections[n.latestCollId]))?(!r||r&&((u=n.localSavedItemsMap[n.currentElementMid])===null||u===void 0?void 0:u.collections[n.latestCollId]))&&n.addElementClass(n.hoverContainerSub,n.SavedCN):n.removeElementClass(n.hoverContainerSub,n.SavedCN);at(e,o,f)}function li(){var h;if(n.ctrl&&(h=n.ctrl.dataset,h)){var y=h.dly,w=h.sfmc,p=h.svctrlv3;y&&(ht=parseInt(y,10));n.savedFormCode||(n.savedFormCode=w);p&&(r=p)}c=_ge("svctrlinlineform");rt=_ge("svctrlnewint");b=_ge("svctrlinlineformcreate");a=_ge("svctrlhvr");t||(t=_ge("svflytc"));i=_ge("svctrllnk");et=_ge("sccolltxt");yt=i.getAttribute("href");ot=_ge("svctrlhvrnum");e=_ge("svctrlerr");o=_ge("svctrlerrtxt");u=_ge("svctrlhvrbtn");ut=_ge("svctrllstw");k=_ge("svctrlhvrpnl");ft=_ge("svctrlmsmtcherrtxt");d=_ge("svctrlmsmtchlnk");v=_ge("svctrlhvrpnlbtn");l=_ge("svctrlinlineformerrdup");c&&(f=_ge("svctrlinlineformname"),n.addClickListener(_ge("svctrlinlineformback"),lt),n.addClickListener(b,ni),f&&(n.addEnterKeyListener(f,ni),n.addListenerToElement(f,"keyup",si)));i&&n.isAnchorElement(i)&&n.addClickListener(i,fi);d&&n.isAnchorElement(d)&&n.addClickListener(d,fi);t&&(n.standalone||(n.addInListeners(t,n.logFlyoutHoverEvent),n.addOutListeners(t,gi)),r||(n.addInListeners(n.ctrlBtn,tr),n.addOutListeners(n.ctrlBtn,ir)),a&&n.addClickListener(u,ki),n.addClickListener(_ge("svctrltri"),rr,!1),t.hasAttribute(n.SaveErrorMapAttr)&&(g=n.parseJsonString(t.getAttribute(n.SaveErrorMapAttr))));sj_evt.bind(n.ControlAppendedEN,ur);sj_evt.bind("onSaveInProgress",wi);sj_evt.bind(n.SaveAddEN,yi);sj_evt.bind(n.SaveDelEN,pi);sj_evt.bind("onHoverContainerHide",tt);sj_evt.bind(n.CurrentCollIdSetEN,bt);sj_evt.bind(n.UpdateHoverBoxEN,ci);sj_evt.bind(n.SaveButtonClickEN,s);n.standalone||sj_evt.bind(n.CollListExpandEN,ii);sj_evt.bind(n.SaveControlErrorEN,hi);n.standalone&&(sj_evt.bind(n.CollectionsGottenEN,vi),sj_evt.bind(n.HostSavesControlClickedEN,ai));sj_evt.bind(n.SaveButtonFocusEN,bi)}function ai(t){var i=t[0],r=t[1];i==n.HostSavesControlClickedEN&&oi(null,null,r)}function vi(t){var i=t[0];i==n.CollectionsGottenEN&&h!=e&&(bt([null,n.currentElementCollId||n.latestCollId]),p(a),ri())}function kt(t){var i;wt(t);(!r||n.isCreateDialogShowing)&&s();gt((i=n.localSavedItemsMap[t])===null||i===void 0?void 0:i.numCollections)}function yi(t){var i,u=t[3];n.currentHoveredElement===u&&(kt(n.currentElementMid),(!r||((i=n.localSavedItemsMap[n.currentElementMid])===null||i===void 0?void 0:i.collections[n.latestCollId]))&&n.addElementClass(n.hoverContainerSub,n.SavedCN))}function pi(t){var i=t[3],r=t[4];n.currentHoveredElement===i&&(kt(n.currentElementMid),r&&n.removeElementClass(n.hoverContainerSub,n.SavedCN))}function dt(){n.removeElementClass(e.querySelector("."+n.SublabelActiveCN),n.SublabelActiveCN)}function wi(t){var i=t[1],r=t[2];n.standalone||(dt(),n.currentHoveredElement===i&&ct(_ge("svctrlhvrpnling"),r))}function bi(){t&&s()}function lt(){u&&c&&(n.removeElementClass(k,n.DeactivateCN),n.removeElementClass(ut,n.DeactivateCN),n.removeElementClass(c,n.FlyoutActiveCN),n.removeElementClass(u,n.DeactivateCN),n.addElementClass(u,n.FlyoutActiveCN),n.setKeepFlyoutActive(!1),f.value="",f.disabled=!0,u.setAttribute("tabindex","0"),i.setAttribute("tabindex","0"),v&&v.setAttribute("tabindex","0"),n.collectionList&&n.collectionList.setAttribute("tabindex","0"),n.isCreateDialogShowing=!1)}function ki(){(n.clearTempCurrentElement(),u&&c)&&(n.addElementClass(k,n.DeactivateCN),n.addElementClass(ut,n.DeactivateCN),n.addElementClass(u,n.DeactivateCN),n.addElementClass(c,n.FlyoutActiveCN),n.removeElementClass(u,n.FlyoutActiveCN),n.setKeepFlyoutActive(!0),f.value="",f.disabled=!1,f.focus(),n.removeElementClass(l,n.ErrDispCN),b.setAttribute("aria-disabled","true"),u.setAttribute("tabindex","-1"),i.setAttribute("tabindex","-1"),v&&v.setAttribute("tabindex","-1"),n.collectionList&&n.collectionList.setAttribute("tabindex","-1"),n.isCreateDialogShowing=!0)}function gt(n){if(ot&&n!==undefined&&n!==null){var t=n-1;r||(ot.textContent=t>0?"+"+t:"")}}function at(u,f,e){var s,h=n.standalone&&((s=t===null||t===void 0?void 0:t.dataset)===null||s===void 0?void 0:s.htc)&&(!e||e==0),o;(h?(i.textContent=t.dataset.htc,it=""):(i.textContent=f,it=u,r&&et&&(et.textContent=f)),n.isAnchorElement(i))&&(o=yt,n.savedFormCode&&(o+="&FORM="+n.savedFormCode),h||(o+="&collId="+u),i.setAttribute("href",o),n.savedLinkSameTab&&i.hasAttribute(n.TargetAttr)?i.removeAttribute(n.TargetAttr):i.setAttribute(n.TargetAttr,"_blank"),gt(e))}function ni(){var i,t;if(n.logCreateButtonClick(n.currentHoveredElement),t=(i=f.value)===null||i===void 0?void 0:i.trim(),t){if(n.isCollectionExists(t)){n.addElementClass(l,n.ErrDispCN);return}n.currentElementTemp=n.currentHoveredElement;p(rt);n.addToNewCollection(t,n.currentElementTemp,null,lt)}}function di(t){n.nextFocusable.focus();n.nextFocusable=null;sj_pd(t)}function gi(i){if(!n.getKeepFlyoutActive()){var r=i.relatedTarget;if(i.type==="focusout"&&!n.elementContains(t,r)&&n.nextFocusable){di(i);return}if(r){if(n.isElementInSpaceOfAnother(t,r))return;if(n.elementContains(n.ctrl,r))return;if(n.isElementInSpaceOfAnother(n.ctrl,r))return}tt();n.clearCurrentHoveredElement()}}function ti(){y&&(sb_ct(y),y=null)}function ii(){var i,u,v,h,c,l,y,e;if(t&&(n.removeElementClass(n.ctrl,n.NarrowImageCN),t.style.removeProperty("left"),t.style.removeProperty("right"),t.style.removeProperty("bottom"),n.removeElementClass(n.ctrl,n.NarrowImageRightCN),n.removeElementClass(n.ctrl,n.NarrowImageBottomCN),i=n.getClientRect(t),i)){var f=Math.min(n.getClientRect(_d.body).width,_w.innerWidth),a=i.width,o=i.right,s=i.left;if(s<0?o+a>f?(n.addElementClass(n.ctrl,n.NarrowImageCN),u=(o-f)/2,s+u<=0&&(u-=nt),t.style.right=u+"px"):n.addElementClass(n.ctrl,n.NarrowImageRightCN):o>f&&(s<a?(n.addElementClass(n.ctrl,n.NarrowImageCN),u=s/2,o-u>=f&&(u+=nt),t.style.left=-1*u+"px"):n.elementHasClass(n.hoverContainerSub,"b_scpers")?i&&i.right>f?(v=f-i.right,t.style.left=v-nt+"px"):n.addElementClass(n.ctrl,n.NarrowImageRightCN):n.addElementClass(n.ctrl,n.NarrowImageRightCN)),h=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.flyoutpos,c=h?3:1,i=n.getClientRect(t),l=Math.min(n.getClientRect(_d.body).height,_w.innerHeight)-i.bottom,y=k.clientHeight+Math.min(3.5,Object.keys(n.localCollectionsMap).length)*48,l<t.clientHeight/c||l<y/c)if(n.addElementClass(n.ctrl,n.NarrowImageBottomCN),h){var b=n.getClientRect(n.ctrlBtn),d=n.getClientRect(n.currentHoveredElement),g=_qs(".svbtnlbl",n.ctrlBtn);i=n.getClientRect(t);g&&(e=n.getClientRect(g),b.left-d.left<d.right-b.right?i.left-e.right<0&&e.right-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"):i.left-e.left<0&&e.left-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"))}else{var p=n.ctrlBtn.clientLeft,tt=n.ctrlBtn.clientWidth,w=t.clientLeft,it=t.clientWidth;p>=w&&p+tt<=w+it&&(t.style.bottom=(r?n.ctrl.clientHeight+nt:n.ctrlBtn.clientHeight)+"px")}}}function nr(){p(a);ct(_ge("svctrlhvrpnltxt"),!0)}function ri(){t&&(n.addElementClass(n.ctrl,n.HasFlyoutCN),dt(),n.standalone||ii(),vt&&n.standalone||(n.logFlyoutShown(n.currentHoveredElement),vt=!0),sj_evt.fire("onResetScroll"),w=!0,ti())}function tt(){t&&(n.removeElementClass(n.ctrl,n.HasFlyoutCN),p(),ti(),w=!1)}function s(){nr();w||ri()}function ui(){s();sj_evt.fire("prismFocusChange",n.currentHoveredElement)}function tr(i){i.relatedTarget&&(n.getKeepFlyoutActive()||(sj_pd(i),sj_sp(i),n.addElementClass(n.ctrl,n.HasFlyoutCN),n.logSvBtnHoverEvent(),n.hoverContainerSub&&n.addElementClass(n.hoverContainerSub,"b_schvr"),sj_evt.fire("onSaveHover"),t&&(ht&&!y?y=sb_st(ui,ht):ui())))}function ir(t){if(t.type==="focusout"){if(n.shiftKeyDown){n.currentFocusTarget&&n.currentFocusTarget.focus();t.stopImmediatePropagation();sj_sp(t);sj_pd(t);return}s();n.elementHasClass(e,n.FlyoutActiveCN)?n.nextFocusable.focus():h.focus();return}if(!n.getKeepFlyoutActive()){var i=t.relatedTarget;if(i){if(n.elementContains(n.ctrl,i))return;if(n.isElementInSpaceOfAnother(n.hoverContainer,i))return}n.clearCurrentHoveredElement();t.type==="mouseleave"&&(n.removeElementClass(n.ctrl,n.HasFlyoutCN),tt())}}function rr(t){var i=n.elementsFromPoint(t.clientX,t.clientY);i&&i.length>1&&i[1].click()}function fi(t){var i=t[n.TargetAttr];si_ct(i,!1,t);n.logLinkClick(n.currentHoveredElement,it);n.standalone&&(sj_evt.fire("onNewTabOpenRequest",i.getAttribute("href")),t.preventDefault());sj_sp(t)}function p(t){var f,i,r,s;if(h&&(n.removeElementClass(h,n.FlyoutActiveCN),f=t==rt,n.setKeepFlyoutActive(f),n.getKeepFlyoutActive()?n.addElementClass(n.ctrl,"b_scnapd"):n.removeElementClass(n.ctrl,"b_scnapd")),!t){h=null;sj_evt.fire(n.VisualStateChangedEN,1);return}n.elementHasClass(n.ctrl,"b_geterr")&&(o.textContent=g[3],n.removeElementClass(o,n.errStateInvisibleCN),n.addElementClass(o,n.errStateVisibleCN),t=e);n.addElementClass(t,n.FlyoutActiveCN);t==a&&(n.addElementClass(u,n.FlyoutActiveCN),lt());h=t;i=null;switch(t){case a:r=_ge("svctrlpckr");r?(s=r.getAttribute("aria-expanded")==="false",i=s?3:4):i=3;break;case e:i=5}sj_evt.fire(n.VisualStateChangedEN,i)}function ur(){i&&(wt(),sj_evt.fire(n.VisualStateChangedEN,2))}function ei(t,i,u){var f=n.localSavedItemsMap[t||n.currentElementMid];f&&f.numCollections>1&&!r?sj_evt.fire(n.ChevronToggleCollListEN):n.handleSaveClick(r?n.latestCollId:n.currentElementCollId||n.latestCollId,"Btn",u,i)}function oi(n,t,i){s();ei(n,t,i)}function fr(){w?tt():s()}function er(n,t,i){ei(n,t,i);ct(_ge("svctrlhvrpnltxt"),!0)}var vt=!1,it,w=!1,h,u,c,f,b,rt,e,o,l,ut,k,ft,d,v,t,a,et,i,yt,ot,st,pt,ht=0,y,g,r=null,nt=5;n.isCreateDialogShowing=!1;n.onSaveControlClicked=oi;n.toggleFlyout=fr;n.onSaveControlIcnClicked=er;li()}(SvCtrlV2||(SvCtrlV2={})),function(n){function l(){s.scrollTop=0}function b(t){var r=t.currentTarget,i=r.getAttribute(n.CollectionIdDataAttribute),f=r.getAttribute(n.KCTDataAttr),u=n.currentHoveredElement;if(i||f)sj_sp(t),sj_pd(t),t.stopImmediatePropagation();else return!0;if(n.logCollLstClick(n.currentHoveredElement,i),i==n.CustomCollDummyId){n.addToNewCollection(n.defOrCustCollName,n.currentHoveredElement,function(){p(n.CustomCollDummyId)});return}r.hasAttribute(n.SavedDataAttr)?n.removeFromCollection(i,c,u):n.addToCollection(i,u,c)}function a(n){var t=n;if(/\/th(\/.*|)\?/i.test(n)){var i=n.split("?"),r=i[0],u=i[1];t=r+"?"+u.replace(/&?\b[whrc]=\d+/gi,"")+w}return t}function k(t){var u=t[1],r=t[2],i=_qs("["+n.CollectionIdDataAttribute+'="'+u+'"] img',n.collectionList);i&&(r?i.src=a(r):i.removeAttribute("src"))}function r(t,i,r){r===void 0&&(r=!1);var u=r?function(n){t.insertBefore(n,t.firstChild)}:function(n){t.appendChild(n)};n.iterateThroughList(i,u)}function i(t,i){var r=function(n,i){i&&t.setAttribute(n,i)};n.iterateOverObject(i,r)}function u(n,t){return sj_ce(n,null,t)}function d(t){var f,y=t[1],p=t[2],w=t[3],v=t[4],k=t[5],d=t[6],h,e,c,l,s;n.collectionList&&(h=u("div","b_svcimg"),e=sj_ce("img"),i(e,{role:"presentation"}),sj_be(e,"error",function(){e.removeAttribute("src")}),v&&(e.src=a(v)),r(h,[e]),c=u("div","b_svclnk"),l=u("p","b_ignbt"),l.textContent=w,r(c,[l]),s=u("li","b_svcitm"),i(s,(f={},f[n.CollectionIdDataAttribute]=p||null,f[n.KCTDataAttr]=k||null,f.tabindex="-1",f.role="option",f["aria-selected"]="false",f)),d&&o(s),r(s,[h,c]),r(n.collectionList,[s],y),n.addClickListener(s,b,!0,!1))}function e(r){var u,e;l();u=!1;r===null||r===undefined?(e=f.getAttribute("aria-expanded"),e!=="false"||h||(n.logCollExpandClick(n.currentHoveredElement),h=!0),u=e==="true"?!1:!0):u=r;i(f,{"aria-expanded":u?"true":"false"});u?n.addElementClass(t,"xpnd"):n.removeElementClass(t,"xpnd");u&&sj_evt.fire(n.CollListExpandEN);n.standalone&&sj_evt.fire(n.VisualStateChangedEN,u?4:3)}function v(t){return _qs("["+n.CollectionIdDataAttribute+"='"+t+"']",n.collectionList)}function o(t){var r;i(t,(r={},r[n.SavedDataAttr]="1",r["aria-selected"]="true",r))}function y(t){var r;t.removeAttribute(n.SavedDataAttr);i(t,(r={},r["aria-selected"]="false",r))}function g(n){var i=n[1],t=v(i);t&&o(t)}function nt(n){var i=n[1],t=v(i);t&&y(t)}function tt(t){var i=t[1];n.iterateThroughList(Array.prototype.slice.call(n.collectionList.childNodes),function(t){i&&t.getAttribute(n.CollectionIdDataAttribute)in i?o(t):y(t)})}function it(t){var i;n.isCreateDialogShowing||(t.keyCode===38?(_d.activeElement.previousElementSibling&&_d.activeElement.previousElementSibling.focus(),sj_sp(t),sj_pd(t)):t.keyCode===40&&(_d.activeElement===n.collectionList?(i=_qs(".b_svcitm"))===null||i===void 0?void 0:i.focus():_d.activeElement.nextElementSibling&&_d.activeElement.nextElementSibling.focus(),sj_sp(t),sj_pd(t)))}function p(t){if(!t||!n.collectionList)return!1;var i=_qs("[".concat(n.CollectionIdDataAttribute,'="').concat(t,'"]'),n.collectionList);return i?(n.collectionList.removeChild(i),!0):!1}function rt(){n.collectionList=_ge("svctrllst");f=_ge("svctrlpckr");s=_ge("svctrllstw");t=_ge("svctrlhvrpnlbtn");t&&n.addClickListener(t,function(){return e()});sj_evt.bind("onCollRegister",d,!0);sj_evt.bind(n.CurrentCollIdSetEN,g);sj_evt.bind("onCurrentCollIdUnset",nt);sj_evt.bind("onChangeCollThumbnail",k);sj_evt.bind("onResetScroll",l);sj_evt.bind(n.HoverElementSetEN,tt);sj_evt.bind(n.ChevronToggleCollListEN,function(){return e(!0)});sj_evt.bind(n.ControlAppendedEN,function(){return e(!1)});sj_evt.bind("onSaveHover",function(){t||sj_evt.fire(n.CollListExpandEN)});n.collectionList&&n.addListenerToElement(n.collectionList,"keydown",it)}var f,s,t,h=!1,c="ColLst",w="&w=40&h=40&c=7&r=0";n.removeCollectionFromPicker=p;rt()}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){n.fireOverlapping(t);sj_sp(t);n.onSaveControlClicked(n.currentElementMid,n.currentHoveredElement,!0)}function i(){n.ctrlBtn&&n.addClickListener(n.ctrlBtn,t,!0)}i()}(SvCtrlV2||(SvCtrlV2={}))